# Предсказание количества прослушиваний релиза в ВК на основании данных о слушательской активности на релизе в TikTok.


В этой работе предпринята попытка проанализировав данные первых 7 дней после публикации треков в
социальной сети TikTok сделать предикт общего количества прослушиваний трека в сети VK в срок 14 или 30 дней после релиза трека.

В ходе работы были использованы разные методы формирования  и обработки датасета, разные модели регрессии и классификации.

В данном ноутбуке приведено решение, которое в итоге дало наименьшую ошибку МАРЕ и наибольший Accuracy.

## Краткая информация о данных

Были использованы данные, предоставленные TikTok и VK (данные не предоставляются широкому кругу населения, информация "ведомственная", поэтому сам датасет загружен на GitHub быть не может.  
Взяты данные по релизам, которые выпущены одним из мейджоров, присутствующих на российском рынке; данные (и по релизам, и по стримам в VK, и по пользовательской активности в TikTok)за 2019-2021 годы. Данные о пользовательской активности TikTok взяты только с учетом данным российских пользователей сети. 

## Этапы работы над проектом

### Формирование датасета.
Сырые данные по TikTok и VK содержат 71 млн строк. Была проведена обработка данных, были сформированые дполнительные признаки, проведена фильтрация по дням, прошедшим после релиза и сформирован итоговый датасет, с которым уже проводились эксперименты по предикту. В ходе экспериментов было отсеяно некоторое количество признаков (оказалось, что информация о лайках в TikToke ухудшает работу моделей, попытка почистить выбросы приводит к тому, что модель не может предсказать будущие хиты (а именно это наиболее интересный сегмент!)

### Регрессия
Были использованы различные модели для регрессии. Наиболее "рабочим" оказался Catboost с тонкими настройками параметров (через OPTUNA).  МАРЕ удалось довести до уровня 6%, но (!) только в том случае, если округлять полученные цифры до кратного 50000 стримов. С одной сторооны это экономически целесообразно (об этом подробнее в самом ноутбуке), с другой стороны это навело на мысль о том, что нужно сделать не регрессию, а классификацию

### Классификация
Все релизы были разбиты на условные три класса по количеству собранных за 30 дней стримов в ВК (подробное описание классов - в ноутбуке). Точность предикта классов составила более 95%. Модель дает пессимистический предикт (то есть склонна к занижению результата), но я не стал это исправлять, так как это имеет "правильный" экономический смысл (издательство не будет рисковать деньгами, вкладываясь в продвижение релиза, который ошибочно определен как позитивный класс). Были использованы разные модели для классификации, в итоге выбрана модель LightGBM с настройками параметров с помощью OPTUNA. 

## Вывод

Несмотря на итоговую скромность входящих данных и очень плохое распределение их (большинство релизов с малым количеством стримов - что и понятно, каждую неделю на рынок выходит несколько десятков треков, но хитами становятся единицы), удалось получить несуществовавший до сих пор объективный инструмент отценки коммерческого потенциала релиза.


```python

```
